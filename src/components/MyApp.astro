---
const city = "Spokane";
let weather = null;
let errorMessage = null;

try {
  // Fetch weather data at build time
  const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${import.meta.env.API_KEY}&units=metric`);
  if (!response.ok) {
    throw new Error("Failed to fetch weather data");
  }
  weather = await response.json();
} catch (error) {
  console.error("Error fetching weather data:", error);
  errorMessage = error.message || "Unable to fetch weather data";
}

// Helper function for wind direction
function getWindDirection(deg) {
  const directions = ["N", "NE", "E", "SE", "S", "SW", "W", "NW"];
  const index = Math.round(deg / 45) % 8;
  return directions[index];
}
---

<div class="weather-container">
  {weather ? (
    <>
      <h1>Weather in {weather.name}, {weather.sys.country}</h1>
      <p class="weather-icon">
        <img src={`https://openweathermap.org/img/wn/${weather.weather[0].icon}@2x.png`} alt={weather.weather[0].description} />
      </p>
     
      <ul class="space-y-2 text-lg">
      <li><strong class="text-yellow-300">Condition:</strong> mist</li>
      <li><strong class="text-blue-300">Temperature:</strong> -0.6°C</li>
      <li><strong class="text-blue-300">Feels Like:</strong> -0.6°C</li>
      <li><strong class="text-blue-300">Humidity:</strong> 87%</li>
      <li><strong class="text-blue-300">Pressure:</strong> 1013 hPa</li>
      <li><strong class="text-blue-300">Visibility:</strong> 4.8 km</li>
      <li><strong class="text-blue-300">Wind Speed:</strong> Calm (N)</li>
      <li><strong class="text-blue-300">Cloud Cover:</strong> 100%</li>
      <li><strong class="text-blue-300">Sunrise:</strong> 3:29:13 PM</li>
      <li><strong class="text-blue-300">Sunset:</strong> 11:57:59 PM</li>
    </ul>
      
    
    
    
    </>
  ) : (
    <p class="text-red-500">{errorMessage || "Unable to fetch weather data"}</p>
  )}
</div>
